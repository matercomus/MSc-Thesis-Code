2025-05-16 14:17:57,251 INFO Random seed set to 42
2025-05-16 14:17:58,085 INFO Saved pip freeze to pipeline_stats/20250516_141756/environment.txt
2025-05-16 14:17:58,086 INFO Loading filtered_points_in_beijing.parquet...
2025-05-16 14:17:58,093 INFO Computing IQR-based thresholds for time gaps and speeds...
2025-05-16 14:17:59,892 INFO Thresholds: time_gap=105.00 sec, speed=146.81 kph
2025-05-16 14:17:59,892 INFO Computing time, distance, speed, and abnormality flags...
2025-05-16 14:17:59,893 INFO Collecting base DataFrame (this may take a while)...
2025-05-16 14:18:04,640 INFO Base DataFrame shape: (12667620, 12)
2025-05-16 14:18:04,640 INFO Detecting trajectory outliers (Isolation Forest, parallel, reproducible)...
2025-05-16 14:19:43,357 INFO Filtering out taxis with any temporal gap or position jump...
2025-05-16 14:19:43,572 INFO Cleaned DataFrame shape: (5378468, 11)
2025-05-16 14:19:43,573 WARNING Cleaned DataFrame contains nulls.
2025-05-16 14:19:44,854 INFO Saved Cleaned points to data/cleaned_points_in_beijing_20250516_141756.parquet (shape: (5378468, 11))
2025-05-16 14:19:45,350 INFO Adding period_id and summarizing periods...
2025-05-16 14:19:45,631 INFO Period summary shape: (31861, 16)
2025-05-16 14:19:45,631 INFO Attaching period_id to cleaned points...
2025-05-16 14:19:46,284 INFO Cleaned with period_id shape: (5377051, 14)
2025-05-16 14:19:47,583 INFO Saved Cleaned points with period_id to data/cleaned_with_period_id_in_beijing_20250516_141756.parquet (shape: (5377051, 14))
2025-05-16 14:19:47,738 INFO Computing per-period outlier counts...
2025-05-16 14:19:48,156 INFO Flagging SLD-based outliers...
2025-05-16 14:19:48,203 INFO Saved Period summary with SLD ratio and outlier flags to data/periods_with_sld_ratio_20250516_141756.parquet (shape: (31603, 20))
2025-05-16 14:19:48,382 INFO [REUSE] OSM graph is up-to-date: beijing_drive.graphml
2025-05-16 14:20:17,675 INFO Loading persistent node cache from network_checkpoints/point_to_node.parquet
2025-05-16 14:20:17,879 INFO Loaded checkpoint with 31603 completed periods.
2025-05-16 14:20:17,898 INFO Processing 0 new periods (skipping 31603 already done).
2025-05-16 14:20:17,930 INFO Computing shortest paths for 0 unique node pairs...
2025-05-16 14:20:17,932 INFO Saved network_shortest_paths statistics to pipeline_stats/20250516_141756/network_shortest_paths_stats_20250516_142017.json
2025-05-16 14:20:18,031 INFO Saved final results to data/periods_with_network_ratio_20250516_141756.parquet
2025-05-16 14:20:18,144 INFO Network ratio outlier threshold: 88.88 (Q1=0.75, Q3=36.00, IQR=35.25)
2025-05-16 14:20:18,144 INFO Found 6696 network outliers out of 31545 valid ratios
2025-05-16 14:20:18,144 INFO Saved network_outlier_flag statistics to pipeline_stats/20250516_141756/network_outlier_flag_stats_20250516_142018.json
2025-05-16 14:20:18,248 INFO Pipeline completed: all parquet files written.
